{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst constants_1 = require(\"../constants\");\n\nfunction assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'Assertion failed');\n  }\n}\n\nexports.assert = assert;\n\nfunction isScalar(x) {\n  return Buffer.isBuffer(x) && x.length === 32;\n}\n\nexports.isScalar = isScalar;\n\nfunction isValidPrivateKey(privateKey) {\n  if (!isScalar(privateKey)) {\n    return false;\n  }\n\n  return privateKey.compare(constants_1.ZERO32) > 0 && privateKey.compare(constants_1.EC_GROUP_ORDER) < 0;\n}\n\nexports.isValidPrivateKey = isValidPrivateKey;\n\nfunction equalConstTime(b1, b2) {\n  if (b1.length !== b2.length) {\n    return false;\n  }\n\n  let res = 0;\n\n  for (let i = 0; i < b1.length; i++) {\n    res |= b1[i] ^ b2[i];\n  }\n\n  return res === 0;\n}\n\nexports.equalConstTime = equalConstTime;\n\nfunction isValidKeyLength(length) {\n  return !(length <= constants_1.LENGTH_0 || length > constants_1.MAX_KEY_LENGTH || parseInt(String(length)) !== length);\n}\n\nexports.isValidKeyLength = isValidKeyLength;","map":{"version":3,"sources":["../../../src/helpers/validators.ts"],"names":[],"mappings":";;;;;;AAAA,MAAA,WAAA,GAAA,OAAA,CAAA,cAAA,CAAA;;AAEA,SAAgB,MAAhB,CAAuB,SAAvB,EAA2C,OAA3C,EAA0D;AACxD,MAAI,CAAC,SAAL,EAAgB;AACd,UAAM,IAAI,KAAJ,CAAU,OAAO,IAAI,kBAArB,CAAN;AACD;AACF;;AAJD,OAAA,CAAA,MAAA,GAAA,MAAA;;AAMA,SAAgB,QAAhB,CAAyB,CAAzB,EAAkC;AAChC,SAAO,MAAM,CAAC,QAAP,CAAgB,CAAhB,KAAsB,CAAC,CAAC,MAAF,KAAa,EAA1C;AACD;;AAFD,OAAA,CAAA,QAAA,GAAA,QAAA;;AAIA,SAAgB,iBAAhB,CAAkC,UAAlC,EAAoD;AAClD,MAAI,CAAC,QAAQ,CAAC,UAAD,CAAb,EAA2B;AACzB,WAAO,KAAP;AACD;;AACD,SACE,UAAU,CAAC,OAAX,CAAmB,WAAA,CAAA,MAAnB,IAA6B,CAA7B,IAAkC,UAAU,CAAC,OAAX,CAAmB,WAAA,CAAA,cAAnB,IAAqC,CADzE;AAGD;;AAPD,OAAA,CAAA,iBAAA,GAAA,iBAAA;;AAUA,SAAgB,cAAhB,CAA+B,EAA/B,EAA2C,EAA3C,EAAqD;AACnD,MAAI,EAAE,CAAC,MAAH,KAAc,EAAE,CAAC,MAArB,EAA6B;AAC3B,WAAO,KAAP;AACD;;AACD,MAAI,GAAG,GAAG,CAAV;;AACA,OAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,EAAE,CAAC,MAAvB,EAA+B,CAAC,EAAhC,EAAoC;AAClC,IAAA,GAAG,IAAI,EAAE,CAAC,CAAD,CAAF,GAAQ,EAAE,CAAC,CAAD,CAAjB;AACD;;AACD,SAAO,GAAG,KAAK,CAAf;AACD;;AATD,OAAA,CAAA,cAAA,GAAA,cAAA;;AAWA,SAAgB,gBAAhB,CAAiC,MAAjC,EAA+C;AAC7C,SAAO,EACL,MAAM,IAAI,WAAA,CAAA,QAAV,IACA,MAAM,GAAG,WAAA,CAAA,cADT,IAEA,QAAQ,CAAC,MAAM,CAAC,MAAD,CAAP,CAAR,KAA6B,MAHxB,CAAP;AAKD;;AAND,OAAA,CAAA,gBAAA,GAAA,gBAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst constants_1 = require(\"../constants\");\nfunction assert(condition, message) {\n    if (!condition) {\n        throw new Error(message || 'Assertion failed');\n    }\n}\nexports.assert = assert;\nfunction isScalar(x) {\n    return Buffer.isBuffer(x) && x.length === 32;\n}\nexports.isScalar = isScalar;\nfunction isValidPrivateKey(privateKey) {\n    if (!isScalar(privateKey)) {\n        return false;\n    }\n    return (privateKey.compare(constants_1.ZERO32) > 0 && privateKey.compare(constants_1.EC_GROUP_ORDER) < 0);\n}\nexports.isValidPrivateKey = isValidPrivateKey;\nfunction equalConstTime(b1, b2) {\n    if (b1.length !== b2.length) {\n        return false;\n    }\n    let res = 0;\n    for (let i = 0; i < b1.length; i++) {\n        res |= b1[i] ^ b2[i];\n    }\n    return res === 0;\n}\nexports.equalConstTime = equalConstTime;\nfunction isValidKeyLength(length) {\n    return !(length <= constants_1.LENGTH_0 ||\n        length > constants_1.MAX_KEY_LENGTH ||\n        parseInt(String(length)) !== length);\n}\nexports.isValidKeyLength = isValidKeyLength;\n//# sourceMappingURL=validators.js.map"]},"metadata":{},"sourceType":"script"}