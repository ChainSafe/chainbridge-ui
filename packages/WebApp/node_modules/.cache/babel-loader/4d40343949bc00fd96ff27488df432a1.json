{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n  result[\"default\"] = mod;\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst aes_js_1 = __importDefault(require(\"aes-js\"));\n\nconst randombytes_1 = __importDefault(require(\"randombytes\"));\n\nconst hash = __importStar(require(\"hash.js\"));\n\nconst pkcs7 = __importStar(require(\"./pkcs7\"));\n\nconst constants_1 = require(\"../constants\");\n\nconst helpers_1 = require(\"../helpers\");\n\nfunction fallbackRandomBytes(length) {\n  return randombytes_1.default(length);\n}\n\nexports.fallbackRandomBytes = fallbackRandomBytes;\n\nfunction fallbackAesEncrypt(iv, key, data) {\n  const aesCbc = new aes_js_1.default.ModeOfOperation.cbc(key, iv);\n  const padded = helpers_1.arrayToBuffer(pkcs7.pad(data));\n  const encryptedBytes = aesCbc.encrypt(padded);\n  return Buffer.from(encryptedBytes);\n}\n\nexports.fallbackAesEncrypt = fallbackAesEncrypt;\n\nfunction fallbackAesDecrypt(iv, key, data) {\n  const aesCbc = new aes_js_1.default.ModeOfOperation.cbc(key, iv);\n  const encryptedBytes = aesCbc.decrypt(data);\n  const padded = Buffer.from(encryptedBytes);\n  const result = helpers_1.arrayToBuffer(pkcs7.unpad(padded));\n  return result;\n}\n\nexports.fallbackAesDecrypt = fallbackAesDecrypt;\n\nfunction fallbackHmacSha256Sign(key, data) {\n  const result = hash.hmac(hash[constants_1.SHA256_NODE_ALGO], key).update(data).digest(constants_1.HEX_ENC);\n  return helpers_1.hexToBuffer(result);\n}\n\nexports.fallbackHmacSha256Sign = fallbackHmacSha256Sign;\n\nfunction fallbackHmacSha512Sign(key, data) {\n  const result = hash.hmac(hash[constants_1.SHA512_NODE_ALGO], key).update(data).digest(constants_1.HEX_ENC);\n  return helpers_1.hexToBuffer(result);\n}\n\nexports.fallbackHmacSha512Sign = fallbackHmacSha512Sign;\n\nfunction fallbackSha256(msg) {\n  const result = hash.sha256().update(msg).digest(constants_1.HEX_ENC);\n  return helpers_1.hexToBuffer(result);\n}\n\nexports.fallbackSha256 = fallbackSha256;\n\nfunction fallbackSha512(msg) {\n  const result = hash.sha512().update(msg).digest(constants_1.HEX_ENC);\n  return helpers_1.hexToBuffer(result);\n}\n\nexports.fallbackSha512 = fallbackSha512;\n\nfunction fallbackRipemd160(msg) {\n  const result = hash.ripemd160().update(msg).digest(constants_1.HEX_ENC);\n  return helpers_1.hexToBuffer(result);\n}\n\nexports.fallbackRipemd160 = fallbackRipemd160;","map":{"version":3,"sources":["../../../src/lib/fallback.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst aes_js_1 = __importDefault(require(\"aes-js\"));\nconst randombytes_1 = __importDefault(require(\"randombytes\"));\nconst hash = __importStar(require(\"hash.js\"));\nconst pkcs7 = __importStar(require(\"./pkcs7\"));\nconst constants_1 = require(\"../constants\");\nconst helpers_1 = require(\"../helpers\");\nfunction fallbackRandomBytes(length) {\n    return randombytes_1.default(length);\n}\nexports.fallbackRandomBytes = fallbackRandomBytes;\nfunction fallbackAesEncrypt(iv, key, data) {\n    const aesCbc = new aes_js_1.default.ModeOfOperation.cbc(key, iv);\n    const padded = helpers_1.arrayToBuffer(pkcs7.pad(data));\n    const encryptedBytes = aesCbc.encrypt(padded);\n    return Buffer.from(encryptedBytes);\n}\nexports.fallbackAesEncrypt = fallbackAesEncrypt;\nfunction fallbackAesDecrypt(iv, key, data) {\n    const aesCbc = new aes_js_1.default.ModeOfOperation.cbc(key, iv);\n    const encryptedBytes = aesCbc.decrypt(data);\n    const padded = Buffer.from(encryptedBytes);\n    const result = helpers_1.arrayToBuffer(pkcs7.unpad(padded));\n    return result;\n}\nexports.fallbackAesDecrypt = fallbackAesDecrypt;\nfunction fallbackHmacSha256Sign(key, data) {\n    const result = hash\n        .hmac(hash[constants_1.SHA256_NODE_ALGO], key)\n        .update(data)\n        .digest(constants_1.HEX_ENC);\n    return helpers_1.hexToBuffer(result);\n}\nexports.fallbackHmacSha256Sign = fallbackHmacSha256Sign;\nfunction fallbackHmacSha512Sign(key, data) {\n    const result = hash\n        .hmac(hash[constants_1.SHA512_NODE_ALGO], key)\n        .update(data)\n        .digest(constants_1.HEX_ENC);\n    return helpers_1.hexToBuffer(result);\n}\nexports.fallbackHmacSha512Sign = fallbackHmacSha512Sign;\nfunction fallbackSha256(msg) {\n    const result = hash\n        .sha256()\n        .update(msg)\n        .digest(constants_1.HEX_ENC);\n    return helpers_1.hexToBuffer(result);\n}\nexports.fallbackSha256 = fallbackSha256;\nfunction fallbackSha512(msg) {\n    const result = hash\n        .sha512()\n        .update(msg)\n        .digest(constants_1.HEX_ENC);\n    return helpers_1.hexToBuffer(result);\n}\nexports.fallbackSha512 = fallbackSha512;\nfunction fallbackRipemd160(msg) {\n    const result = hash\n        .ripemd160()\n        .update(msg)\n        .digest(constants_1.HEX_ENC);\n    return helpers_1.hexToBuffer(result);\n}\nexports.fallbackRipemd160 = fallbackRipemd160;\n//# sourceMappingURL=fallback.js.map"]},"metadata":{},"sourceType":"script"}